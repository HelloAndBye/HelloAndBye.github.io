
一款支持表单提交、Excel数据写入与下载的Web系统，内置标准Excel模板，开箱即用。

## 📋 功能介绍
1. **表单管理**：服务需求单 + 运输业务单（独立标签页切换）
2. **Excel导出（双重方式）**：
   - 快速下载：勾选「外部加油」复选框 → 直接触发下载（适配外部加油场景）
   - 通用下载：点击头部「下载Excel（模板/数据）」按钮 → 适配所有场景
   - 智能命名：无数据→空白模板 / 有数据→含时间戳的完整数据文件
3. **数据写入**：表单提交后自动写入Excel对应工作表
4. **跨平台支持**：Windows/Mac/Linux均可运行

## 🚀 快速启动
### Windows系统
1. 解压压缩包，双击运行 `start_windows.bat`
2. 等待依赖安装完成后，访问 `http://localhost:5000`

### Mac/Linux系统
1. 解压压缩包，打开终端进入项目目录
2. 执行命令：`chmod +x start_mac_linux.sh`（赋予执行权限）
3. 执行命令：`./start_mac_linux.sh`
4. 访问 `http://localhost:5000`

## 📝 使用步骤
### 场景1：快速下载（外部加油服务专用）
1. 启动服务后，访问 `http://localhost:5000`
2. （可选）填写服务需求单基本信息（车号、车辆位置等）
3. 勾选「外部加油」复选框 → 自动触发Excel下载，页面显示提示信息
4. 在浏览器下载文件夹中找到文件，完成记录/填写

### 场景2：通用下载（其他服务/批量数据）
1. 填写对应表单信息（服务需求单/运输业务单）
2. 点击表单底部「提交」按钮（数据自动写入Excel）
3. 点击头部「下载Excel（模板/数据）」按钮 → 获取完整文件

### 场景3：仅需空白模板
直接点击头部「下载Excel（模板/数据）」按钮 → 下载空白标准模板

## ⚠️ 注意事项
1. 需安装Python 3.8+（启动脚本会自动检查）
2. 启动时确保网络通畅（需下载依赖包）
3. 提交数据时请勿打开Excel文件（避免文件占用）
4. 服务默认端口5000，若被占用可修改`app.py`中`port=5000`为其他端口
5. 勾选「外部加油」后，若未下载文件，请检查浏览器下载权限

## ❌ 常见问题
### 1. 启动脚本报错「未检测到Python」
- 解决方案：安装Python 3.8+，安装时勾选「Add Python to PATH」

### 2. 依赖安装超时
- 解决方案：脚本已使用清华镜像源，若仍超时请检查网络

### 3. 表单提交失败
- 解决方案：关闭已打开的Excel文件，重新提交

### 4. 下载Excel中文乱码
- 解决方案：无需处理，程序已优化编码，兼容所有浏览器

### 5. 勾选外部加油未触发下载
- 解决方案：检查浏览器是否拦截下载，或直接使用头部下载按钮

## 📁 项目结构
